import Foundation
/// ** å‰‘æŒ‡ Offer 60. n ä¸ªéª°å­çš„ç‚¹æ•°**
/// æŠŠ n ä¸ªéª°å­æ‰”åœ¨åœ°ä¸Šï¼Œæ‰€æœ‰éª°å­æœä¸Šä¸€é¢çš„ç‚¹æ•°ä¹‹å’Œä¸º s ã€‚
/// è¾“å…¥ nï¼Œæ‰“å°å‡º s çš„æ‰€æœ‰å¯èƒ½çš„å€¼å‡ºçŽ°çš„æ¦‚çŽ‡ã€‚
///
/// ä½ éœ€è¦ç”¨ä¸€ä¸ªæµ®ç‚¹æ•°æ•°ç»„è¿”å›žç­”æ¡ˆï¼Œå…¶ä¸­ç¬¬ i ä¸ªå…ƒç´ ä»£è¡¨è¿™ n ä¸ªéª°å­æ‰€èƒ½
/// æŽ·å‡ºçš„ç‚¹æ•°é›†åˆä¸­ç¬¬ i å°çš„é‚£ä¸ªçš„æ¦‚çŽ‡ã€‚
class Solution {
    /// åˆ©ç”¨åŠ¨æ€è§„åˆ’è®¾å·²çŸ¥ n-1 ä¸ªéª°å­çš„æ¦‚çŽ‡æ±‚æ·»åŠ ä¸€ä¸ªéª°å­ n ä¸ªéª°å­çš„æ¦‚çŽ‡åˆ†å¸ƒ
    /// ä¸è®ºæ·»åŠ çš„ä¸€ä¸ªéª°å­çš„ç‚¹æ•° i ä¸ºå¤šå°‘ï¼Œè®¾ç‚¹æ•°ä¹‹å’Œä¸º xï¼Œåªè¦å‰ n-1 ä¸ªéª°å­
    /// ä¹‹å’Œä¸º x-i å³å¯å¾—åˆ°ç‚¹æ•°ä¹‹å’Œä¸º x çš„æ¦‚çŽ‡
    /// **ä¸¾ä¾‹ï¼š**
    /// è®°å½•ä¸€ä¸ªéª°å­çš„ç»“æžœä¸º [0.16667, 0.16667, 0.16667, 0.16667, 0.16667, 0.16667]
    /// åˆ™ä¸¤ä¸ªéª°å­çš„æ±‚å’Œç»“æžœèŒƒå›´ä¸º 2ï½ž12
    /// ä»¥æ€»ç‚¹æ•°ä¸º2ä¸¾ä¾‹ï¼Œå½“æ€»ç‚¹æ•°å’Œä¸º x = 2 æ—¶ï¼Œ
    ///     - æ–°åŠ å…¥çš„éª°å­ç‚¹æ•°ä¸º 1 æ­¤æ—¶æ¦‚çŽ‡ä¸º P(å‰ n-1 ä¸ªéª°å­ä¹‹å’Œä¸º1)âœ–ï¸P(æ–°åŠ å…¥éª°å­ç‚¹æ•°ä¸º1)
    ///     - æ–°åŠ å…¥çš„éª°å­ç‚¹æ•°ä¸º 2 æ­¤æ—¶æ¦‚çŽ‡ä¸º P(å‰ n-1 ä¸ªéª°å­ä¹‹å’Œä¸º0)âœ–ï¸P(æ–°åŠ å…¥éª°å­ç‚¹æ•°ä¸º2)
    ///     . . .
    ///     - æ–°åŠ å…¥çš„éª°å­ç‚¹æ•°ä¸º 6 æ­¤æ—¶æ¦‚çŽ‡ä¸º P(å‰ n-1 ä¸ªéª°å­ä¹‹å’Œä¸º-4)âœ–ï¸P(æ–°åŠ å…¥éª°å­ç‚¹æ•°ä¸º6)
    /// å°†ä¸Šè¿°æ‰€æœ‰æ¦‚çŽ‡ç›¸åŠ å³å¯å¾—åˆ° 2 ä¸ªéª°å­æ€»ç‚¹æ•°å’Œä¸º x = 2 æ—¶çš„æ¦‚çŽ‡
    func dicesProbabilitySoulution1(_ n: Int) -> [Double] {
        /// ä¸€ä¸ªéª°å­çš„æ¦‚çŽ‡æƒ…å†µ
        var dp: [Double] = Array(repeating: 1/6, count: 6)
        if n == 1 { return dp }
        /// éåŽ†å¤šæ¬¡ä¸æ–­è¿­ä»£ç”Ÿæˆæ–°çš„DP
        for index in 2...n {
            var (dpCount, nextDP): (Int, [Double]) = (dp.count - 1, [])
            /// æ€»éª°å­ç‚¹æ•°ä¸º nï½ž6n
            for total in index...6*index {
                /// è®¡ç®—æ€»ç‚¹æ•°ä¸º total æ—¶å€™çš„æ¦‚çŽ‡
                var probability: Double = 0.0
                /// æ–°åŠ å…¥çš„éª°å­çš„ç‚¹æ•°å–å€¼èŒƒå›´ä¸º1ï½ž6
                for i in 1...6 {
                    /// æ¯æ¬¡è¿­ä»£ä¹‹åŽ dp å†…æœ€å°ç‚¹æ•°ä¼šå‘ç”Ÿå˜åŒ–å› æ­¤ç´¢å¼•çš„ä½ç½®ä¸æ˜¯
                    /// å•çº¯çš„ total - i - 1
                    if ((total - i - (index-1) >= 0) &&
                        (total - i - (index-1) <= dpCount)) {
                        probability += dp[total-i-(index-1)]*(1/6)
                    }
                }
                nextDP.append(probability)
            }
            dp = nextDP
        }
        return dp
    }
    
    /// 1. ç¡®å®šçŠ¶æ€ä¸Žé€‰æ‹©
    ///     - çŠ¶æ€: éª°å­æ€»ç‚¹æ•°å’Œçš„ä¸ªæ•° N = 5âœ–ï¸nâž•1ï¼Œä¸Žéª°å­çš„ä¸ªæ•° M
    ///     - é€‰æ‹©: æ˜¯å¦é€‰æ‹©å½“å‰éª°å­çš„æ•°å­—ï¼Œç”±äºŽæ¶‰åŠä¸¤ä¸ªéª°å­ï¼Œå› æ­¤æ— è®ºå¦‚ä½•å½“å‰éª°å­éƒ½è¦é€‰æ‹©ã€‚
    /// 2. ç¡®è®¤dpçš„ç›¸å…³ä¿¡æ¯
    ///     - dpçš„ç»´åº¦, dp[M][N]
    ///     - dp[i][j]è¡¨ç¤ºéª°å­ä¸ªæ•°ä¸º i ç‚¹æ•°å’Œä¸º j æ—¶å€™çš„æ¦‚çŽ‡
    func dicesProbability(_ n: Int) -> [Double] {
        /// éª°å­æ€»ç‚¹æ•°å’Œçš„ä¸ªæ•° Nï¼Œéª°å­çš„ä¸ªæ•° M
        let (N, M): (Int, Int) = (6*n, n)
        var dp: [[Double]] = Array(repeating: Array(repeating: 0, count: N + 1), count: M + 1)
        /// å½“éª°å­ä¸º0ä¸ªçš„æ—¶å€™ï¼Œç‚¹æ•°åªå’Œä¸º0çš„æ¦‚çŽ‡ä¸º 1
        dp[0][0] = 1
        
        for i in 1...M {
            for j in 1...N {
                /// ç‚¹æ•°æ€»å’Œä¸º j æ—¶å€™çš„æ¦‚çŽ‡ç­‰äºŽå½“å‰éª°å­ðŸŽ²çš„ç‚¹æ•° k çš„æ¦‚çŽ‡ âœ–ï¸ å‰ i-1 ä¸ªéª°å­çš„ç‚¹æ•°æ€»å’Œä¸º j - k æ—¶å€™çš„æ¦‚çŽ‡ï¼Œkå–1ï½ž6
                for k in 1...6 {
                    if j >= k {
                        dp[i][j] += (dp[i-1][j-k] * 1.0/6.0)
                    }
                }
            }
        }
        return Array(dp.last![M...N])
    }
}

let solution = Solution()
print(solution.dicesProbability(1))
print(solution.dicesProbability(2))
print(solution.dicesProbability(3))
